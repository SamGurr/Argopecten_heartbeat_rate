heart
DF_means <- heart %>% dplyr::select(-c(1:2, 11:16)) # select the subtracted (corrected) hreat rate values and the insitu mean characteristics by site
# laod table
heart <- read.csv(file="Data/Post_insitu_experiment/Heartbeat_data/SUMMARY/Heartbeat_rate_intial_exposure_recovery_MEAN.csv", header=T) #read Size.info data
heart
DF_means <- heart %>% dplyr::select(-c(1:2, 11:16)) # select the subtracted (corrected) hreat rate values and the insitu mean characteristics by site
DF_means
heart.rates <- DF_means %>% dplyr::select(c(1:8)) # exposure hrs 1,2,3,8,9,15,16; recovery hr 1
DF_means
vars <- DF_means %>% dplyr::select(c(9:37)) # 30 total variables (5 DO thresholds * 6 characteristics; mag, freq, % time, count, EQ)
vars
ncol(vars)
heart
Summary_TABLE <- data.frame() # run this before the loop
for(i in 1:ncol(heart.rates)){
for(m in 1:ncol(vars)) {
# loop linear regressions for rquared and p values
rsq <- summary(lm(heart.rates[,i] ~ vars[,m]))$r.squared
pval <- summary(lm(heart.rates[,i] ~ vars[,m]))$coef[2,"Pr(>|t|)"]
# assign the data table
RSQ.loop <- data.frame(matrix(nrow = 1, ncol = 4)) # create a new data table
colnames(RSQ.loop) <- c('heart.meas', 'hypoxia.characteristic', 'rsq', 'pval') # assign headers
RSQ.loop$heart.meas <- colnames(heart.rates[i])
RSQ.loop$hypoxia.characteristic <- colnames(vars[m])
RSQ.loop$rsq <- rsq
RSQ.loop$pval <- pval
# loop additions
df <- data.frame(RSQ.loop) # name dataframe for this single row
Summary_TABLE <- rbind(Summary_TABLE,df) # bind to a cumulative list dataframe
}# inside loop'
print(Summary_TABLE) # show loop progress in the console
}# outside loo
# Dummy data
Summary_TABLE2 <- Summary_TABLE %>%
dplyr::filter(!hypoxia.characteristic  %in% c("Salinity", "secchi_depth", "site_depth", "chl_a_ug_l")) %>%
separate(hypoxia.characteristic, c("Descriptor", "DO_threshold"), "_")
Summary_TABLE2 <- separate(hypoxia.characteristic, c("Descriptor", "DO_threshold"), "_")
Summary_TABLE2
HR_1 <-  Summary_TABLE2 %>% dplyr::filter(heart.meas %in% "SUB_1_hr_init")
x <- HR_1$Descriptor
y <- HR_1$DO_threshold
data <- expand.grid(X=x, Y=y)
data
data$Z <- HR_1$rsq
data
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
data
x <- HR_1$Descriptor
y <- HR_1$DO_threshold
data$Z <- HR_1$rsq
# Heatmap
ggplot(data, aes(X, Y, fill= Z)) +
geom_tile()
data
x <- HR_1$Descriptor
y <- HR_1$DO_threshold
data$Z <- HR_1$rsq
data
x <- HR_1$Descriptor
x
y <- HR_1$DO_threshold
y
# Heatmap
ggplot(HR_1, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile()
# Heatmap
ggplot(HR_1, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey")
# Heatmap
ggplot(HR_1, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey", values = c(0,0.2,0.4,0.6,0.8,1))
Summary_TABLE2
# Heatmap
ggplot(Summary_TABLE2, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile() +
facet_wrap(heart.meas )
# Heatmap
ggplot(Summary_TABLE2, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile() +
facet_wrap(-heart.meas)
Summary_TABLE2
# Heatmap
ggplot(Summary_TABLE2, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile() +
facet_wrap(heart.meas)
# Heatmap
ggplot(Summary_TABLE2, aes(DO_threshold, Descriptor, fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(heart.meas ~ ., scales = "free")
# Heatmap
ggplot(Summary_TABLE2, aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(heart.meas ~ ., scales = "free")
Summary_TABLE2
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(Summary_TABLE2, aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(heart.meas ~ ., scales = "free")
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(heart.meas ~ ., scales = "free")
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(heart.meas ., scales = "free")
?facet_grid
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free")
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(fill = rsq, label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(fill = rsq, label = rsq))
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
# all plots
Summary_TABLE2$rsq <- format(round(rsq, 2), nsmall = 2)
Summary_TABLE2
# Dummy data
Summary_TABLE2 <- Summary_TABLE %>%
dplyr::filter(!hypoxia.characteristic  %in% c("Salinity", "secchi_depth", "site_depth", "chl_a_ug_l")) %>%
separate(hypoxia.characteristic, c("Descriptor", "DO_threshold"), "_")
# Heatmaps
ggplot(Summary_TABLE2, aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(heart.meas ~ ., scales = "free")
# all plots
format(round(Summary_TABLE2$rsq, 2))
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
# all plots
format(round(Summary_TABLE2$rsq, 2))
# all plots
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 2))
Summary_TABLE2$rsq
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
# all plots
Summary_TABLE2$rsq <- as.numeric(format(round(Summary_TABLE2$rsq, 2)))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold,  fill= rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "black") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
# all plots
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 3))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_distiller(palette = "Spectral") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_distiller(palette = "Spectral") +
theme(axis.text.x = element_text(angle = 270)) +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_distiller(palette = "Spectral") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_colour_brewer() +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_gradient(low = "#132B43", high = "#56B1F7") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_gradient2(low = muted("red"),
mid = "white",
high = muted("blue")) +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_gradient2(low = "red",
mid = "white",
high = "blue") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold)) +
#geom_tile(aes(fill = rsq), colour = "white") +
scale_fill_gradient2(low = "red",
mid = "white",
high = "blue") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient2(low = "red",
mid = "white",
high = "blue") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey80") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 3))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 4))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Summary_TABLE2 <- Summary_TABLE %>%
dplyr::filter(!hypoxia.characteristic  %in% c("Salinity", "secchi_depth", "site_depth", "chl_a_ug_l")) %>%
separate(hypoxia.characteristic, c("Descriptor", "DO_threshold"), "_")
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 4))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 4))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 3))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
Plots_hr_2_3_recovery <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
Plots_hr_2_3_recovery # view plots
RSQ_Heatmap_Plots # view plots
Summary_TABLE2$rsq <- format(round(Summary_TABLE2$rsq, 3))
Summary_TABLE2$rsq <-as.numeric(Summary_TABLE2$rsq)
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
Summary_TABLE2$pval <- format(round(Summary_TABLE2$pval, 3))
Summary_TABLE2$pval <-as.numeric(Summary_TABLE2$pval)
Pval_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = pval)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = pval))
Pval_Heatmap_Plots # view plots
Pval_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = pval)) +
geom_tile() +
scale_fill_gradient(low = "grey50", high = "white") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = pval))
Pval_Heatmap_Plots # view plots
RSQ_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
Summary_TABLE2
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanDuration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
Pval_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = pval)) +
geom_tile() +
scale_fill_gradient(low = "grey50", high = "white") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = pval))
Pval_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq),color = "black", fill="#69b3a2")
RSQ_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq), label.padding = unit(0.55, "lines"),
label.size = 0.35,color = "black", fill="#69b3a2")
RSQ_Heatmap_Plots # view plots
RSQ_Heatmap_Plots <- Summary_TABLE2 %>%
#format(round(rsq, 2), nsmall = 2) %>%
dplyr::filter(heart.meas %in% c("SUB_1_hr_init", "SUB_2_hr_init", "SUB_3_hr_init", "Recovery_1_hr")) %>%
dplyr::filter(!Descriptor %in% c("MeanConcentration", "EQ")) %>%
ggplot(aes(Descriptor,DO_threshold, fill = rsq)) +
geom_tile() +
scale_fill_gradient(low = "white", high = "grey50") +
facet_grid(. ~ heart.meas, scales = "free") +
geom_text(aes(label = rsq))
RSQ_Heatmap_Plots # view plots
